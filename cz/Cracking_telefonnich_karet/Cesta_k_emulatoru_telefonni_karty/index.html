<!DOCTYPE html>
<html>
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.2.0">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Cesta k emulátoru telefonní karty</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css">
  <link rel="alternate" type="application/atom+xml" href="http://blog.rfox.eu/atom_cz.xml">
  <link rel="shortcut icon" href="/favicon.ico">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Bystroushaak">
  <meta name="twitter:creator" content="@Bystroushaak">
  <meta name="twitter:title" content="Cesta k emulátoru telefonní karty">
  <meta name="twitter:description" content="Popis a analýza různých strategií vedoucích k výrobě crackeru telefonních karet.">
  <meta name="twitter:image" content="http://blog.rfox.eu/cz/Cracking_telefonnich_karet/Cesta_k_emulatoru_telefonni_karty/drawing_sz04u9KlXrXtxLxwQ3wJ_VA_353.png">
  <script src="../../../scripts.js">
  </script>
  <meta name="description" content="Popis a analýza různých strategií vedoucích k výrobě crackeru telefonních karet."><!-- Global site tag (gtag.js) - Google Analytics -->

  <script src="https://www.googletagmanager.com/gtag/js?id=UA-142545439-1">
  </script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-142545439-1');
  </script>
  <script data-ad-client="ca-pub-8322439660353685" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async>
  </script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
</head>
<body onload="on_body_load();">
  <div id="sidebar_top">
    <div id="last_five_top">
      <h3>New posts:</h3>
      <ul>
        <li>
          <a href="https://blog.rfox.eu/atom_cz.xml">Vytvořen nový Atom (RSS) feed pro českou sekci</a>
        </li>
      </ul>
    </div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8322439660353685" data-ad-slot="8589969791" data-ad-format="auto" data-full-width-responsive="true"></ins> 
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div><a class="breadcrumb" href="../../../index.html" title="Bystroushaak's blog">Bystroushaak's blog</a> / <a class="breadcrumb" href="../../index.html" title="Czech section">Czech section</a> / <a class="breadcrumb" href="../index.html" title="Cracking telefonních karet">Cracking telefonních karet</a> / Cesta k emulátoru telefonní karty
  <article id="771a3067-17d2-4985-b960-3497952f271c" class="page sans">
    <header>
      <h1 class="page-title">Cesta k emulátoru telefonní karty</h1>
    </header>
    <div class="page-body">
      <p id="51b524e9-a94c-490e-95fa-a75aa867390c" class=""><time>@2009/12/07</time></p>
      <h1 id="ab55b687-f1df-4811-947f-484475152edb" class="">Prohlášení</h1>
      <p id="79adbf93-8188-46d4-a4e5-1b3d9732ede7" class="">Tento článek je něco jako myšlenková hra, cosi jako šachy bez šachovnice. Při této hře se navrhují jednotlivé akce a protiakce, útoky a obrana, v diskuzi se probírá se co by se stalo kdyby ..</p>
      <p id="98a13974-8cbd-43d4-a5b6-f44a4fa79e54" class="">Pokud se kdokoliv rozhodne na základě tohoto článku páchat trestnou činnost, je to jen jeho rozhodnutí a autor tohoto článku s tím rozhodně odmítá mít cokoliv společného. Jinak řečeno; Autor na sebe nebere jakoukoliv zodpovědnost za způsob jakým čtenáři mohou naložit s informacemi, které jsou v článku uvedené. Pokud s tímto jakožto potenciální čtenář(ka) nesouhlasíte, plánujete porušit zákon nebo tušíte že by jste nabyté informace nedokázal(a) udržet v teoretické rovině, já jakožto autor vám neuděluji svolení článek dále číst. V opačném případě můžete pokračovat.</p><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-8322439660353685" data-ad-slot="8927869381"></ins> 
      <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      <h1 id="7da3fb90-e125-45fc-bcb1-af0f525e578f" class="">Úvod</h1>
      <p id="97115dc5-e061-4644-8fee-1e51b045502c" class="">Tento text jsem sepsal abych si utřídil myšlenky a zároveň shrnul na internetu volně dostupné informace o zabezpečení telefonních karet do krátkého článku v češtině. Článek dále předkládá teoretické možnosti jak toto zabezpečení zlomit, přičemž se (bohužel ;) nejedná o návod, ale pouze o informace, které by měly podnítit další diskuzi a posunout tak tuto myšlenkovou hru do dalšího kola.</p>
      <p id="9b4babab-f33c-4470-bdb0-c48feafc034f" class="">Možná že někoho napadne proč se vlastně snažit, když má dnes v podstatě každý svůj vlastní mobil, popřípadě může volat přes VoIP? Obecnou odpověď na tuto otázku nemám, ale za sebe můžu říct, že je docela zábava snažit se proniknout do technologie o které se toho moc neví a která navíc zůstává po dlouhá léta nepokořená (alespoň nevím že by se někomu povedlo emulovat moderní karty).</p>
      <h1 id="535a6b16-ea2f-4f10-8b04-5919b80e037b" class="">Telefonní karta</h1>
      <p id="6a39a707-00a2-4a5b-bad0-8c4b447e04ee" class="">Jak asi každý ví, telefonní karta je zařízení které umožňuje telefonovat, posílat SMS a emaily z tzv. telefonního automatu. Každá karta má v sobě nějakým způsobem uloženy informace o počtu jednotek. Pokud kartu vložíme do automatu, tak jako první proběhne ověření platnosti karty pomocí tzv challenge/response protokolu. Pokud prověrka proběhne správně, automat vám dovolí volat (posílat emaily, SMS, etc..) dokud bude na kartě dostatečný počet jakéhosi kreditu. Pokud ověření karty neproběhne korektně, nebo na kartě nejsou jednotky, automat vydá vysoký pískavý zvuk a na displeji se objeví výzva k vyjmutí karty.</p>
      <p id="a92309b8-e7c8-4225-8cae-216d6ad40f32" class="">Pokud jste pozorně četli předchozí odstavec, možná vás napadlo, jak jsou jednotky na kartě uloženy a jestli by je nešlo po provolání zase přidat. Bohužel, u moderních karet by něco podobného opravdu nešlo.</p>
      <p id="757d0cc8-6b6c-4a70-b9d9-6a0e470ec4f8" class="">V dobách dávno minulých byly jednotky na kartě reprezentovány (EE)PROM pamětí, kterou automat po každém čtení dekrementoval o 1. Jak je asi každému jasné, brzo se našli lidé, kteří zjistili jak na EEPROM zapisovat a začali si karty dobíjet, popřípadě z EEPROM pamětí vytvořili emulátory PROM karet. Telefonní společnosti na to reagovaly tak, že k jednoduché paměti přidali mikroprocesor, který dovolil pouze odečítat jednotky. Aby kartu nebylo možné jednoduše emulovat, byl přidán i mechanismus, který umožnil ověřit jestli je karta pravá. Tento mechanismus se nazývá challenge/response a bude o něm řeč v další části článku.</p>
      <p id="d1433f4b-c02c-413f-aee2-6036461c6faf" class="">Pokud někoho zajímají podrobnosti o hardware karty, dají se najít zde; <a href="http://gsho.thur.de/gsho/phonecard/bin/phonecards_204.txt">http://gsho.thur.de/gsho/phonecard/bin/phonecards_204.txt</a>, nebo v ISO normách.</p>
      <p id="41a4d380-fafc-4182-89b2-bff64aee430d" class="">Dle <a href="http://hw.cz/Teorie-a-praxe/Navrhy-vyvojare/ART1444-Slovenske-telefonne-karty-po-druhe.html">článku na serveru hw.cz</a> vypadá průběh ověřování přibližně takto:</p>
      <h2 id="e5d52324-573a-488e-80a4-baae02dffbb3" class="">Úvod</h2>
      <p id="b5b5133e-175c-45d1-94e9-d322a58c54f6" class="">Tento text jsem sepsal abych si utřídil myšlenky a zároveň shrnul na internetu volně dostupné informace o zabezpečení telefonních karet do krátkého článku v češtině. Článek dále předkládá teoretické možnosti jak toto zabezpečení zlomit, přičemž se (bohužel ;) nejedná o návod, ale pouze o informace, které by měly podnítit další diskuzi a posunout tak tuto myšlenkovou hru do dalšího kola.</p>
      <p id="d75b7ed5-ff7d-4ec9-a2ef-b1fb962ee27a" class="">Možná že někoho napadne proč se vlastně snažit, když má dnes v podstatě každý svůj vlastní mobil, popřípadě může volat přes VoIP? Obecnou odpověď na tuto otázku nemám, ale za sebe můžu říct, že je docela zábava snažit se proniknout do technologie o které se toho moc neví a která navíc zůstává po dlouhá léta nepokořená (alespoň nevím že by se někomu povedlo emulovat moderní karty).</p>
      <h2 id="ac768a17-a72b-4244-a52d-42b69952979c" class="">Popis challenge/response protokolu</h2>
      <p id="150528a4-3070-466f-9b6f-a4ebe4641144" class="">Dle <a href="http://hw.cz/Teorie-a-praxe/Navrhy-vyvojare/ART1444-Slovenske-telefonne-karty-po-druhe.html">článku na serveru hw.cz</a> vypadá průběh ověřování přibližně takto:</p>
      <h3 id="dc2058d6-3e4a-47fd-883f-4121ec0e4b16" class="">Telefonní automat si po vložení karty vyžádá její obsah</h3>
      <figure id="6a7a8542-9b0a-43d4-b7e4-56fc1e6e6ac9" class="image">
        <a href="drawing_skaUBmJDPx-o6MroRkxgU2g_25.png" title="drawing_skaUBmJDPx-o6MroRkxgU2g_25.png"><img style="width:400px" src="drawing_skaUBmJDPx-o6MroRkxgU2g_25.png"></a>
      </figure>
      <h3 id="8bd25968-c6c9-427b-8bb6-f95702108925" class="">Automat na obsah uplatní hash funkci, do které spolu s obsahem karty vstupuje i 48b náhodné číslo</h3>
      <figure id="41928336-3a1d-4b11-b76b-969e0e36860c" class="image">
        <a href="drawing_spyvjLV6CYpaiFBTyhSjqdQ_40.png" title="drawing_spyvjLV6CYpaiFBTyhSjqdQ_40.png"><img style="width:400px" src="drawing_spyvjLV6CYpaiFBTyhSjqdQ_40.png"></a>
      </figure>
      <h3 id="3509602a-cb62-429d-9bd0-3a779e29b932" class="">Telefonní automat pošle kartě stejné náhodné číslo (challenge)</h3>
      <figure id="8a58200a-89ca-4eb4-b2ce-b24850ea2fa4" class="image">
        <a href="drawing_suu7y0AKD916o4hsvJE9DYQ_14.png" title="drawing_suu7y0AKD916o4hsvJE9DYQ_14.png"><img style="width:400px" src="drawing_suu7y0AKD916o4hsvJE9DYQ_14.png"></a>
      </figure>
      <h3 id="562c9e6d-a96c-408b-bb0d-70d40e135aa0" class="">Telefonní karta pomocí stejné hash funkce spočítá odpověď (response) a odešle jí automatu</h3>
      <figure id="ab5cfe7a-837d-42fa-afba-2214d51fcee1" class="image">
        <a href="drawing_sVosRyOBrNjXrYz7Zrnc-fw_2.png" title="drawing_sVosRyOBrNjXrYz7Zrnc-fw_2.png"><img style="width:400px" src="drawing_sVosRyOBrNjXrYz7Zrnc-fw_2.png"></a>
      </figure>
      <h3 id="609f0614-0d77-419e-a901-bfe087c4250a" class="">Pokud se obě čísla schodují, je karta uznána jako platná</h3>
      <p id="cdee4432-ccc3-489f-a9ec-20f5bb58d498" class="">Poněkud odlišný popis se dá najít zde;</p>
      <ul id="69852a1d-aa5d-42c4-a0b4-ca85b5e78499" class="bulleted-list">
        <li>
          <a href="http://www.ciscom.ru/hackersrussia/Cards/Syncro/Eurochip.txt">http://www.ciscom.ru/hackersrussia/Cards/Syncro/Eurochip.txt</a>
        </li>
      </ul>
      <p id="70575e38-1df6-4be4-91c9-f42ff0fcdf00" class="">Z výše popsaného postupu vyplývá, že jediné co brání stavbě emulátoru karty je znalost (resp. neznalost) hash algoritmu. Algoritmus se bohužel jen tak sehnat nedá, proto vidím jedinou možnost ho zjistit pomocí níže uvedených metod.</p>
      <h1 id="d0994954-4208-44e2-b9f6-94cd5c8f9c06" class="">Možnosti prolomení c/r</h1>
      <h2 id="88e51a40-5b8b-4d82-8708-e4c73d4ffe30" class="">MITM sniffer</h2>
      <p id="d1d38f3a-7ee0-4fa3-ad30-f230e8419051" class="">Jedna z lehčích možností je postavit zařízení na odposlech komunikace mezi kartou a automatem. Po nashromáždění určitého počtu záznamů komunikace by pak mělo stačit sestavit bruteforce cracker (rozebráno dále) a pokusit se zlomit algoritmus.</p>
      <h3 id="c01e8e58-e183-4182-bdcf-532f5caac3a1" class="">Výhody</h3>
      <ul id="af4bbda7-5bfe-4379-809b-1e79c1f211fb" class="bulleted-list">
        <li>Dost možná nízká cena</li>
      </ul>
      <ul id="5d395220-7f2a-4ea6-9e20-0bf2270376de" class="bulleted-list">
        <li>Relativně nízká náročnost</li>
      </ul>
      <h3 id="8700f29d-3db6-4c33-a625-de0d0abea50b" class="">Nevýhody</h3>
      <ul id="3651e4d7-c65a-42ea-800f-f6edfab8f2bf" class="bulleted-list">
        <li>Dlouhý čas sběru informací
          <ul id="ce302995-2494-45e4-be06-0bc09ed8c01f" class="bulleted-list">
            <li>Při každém vložení karty proběhne autentizace</li>
          </ul>
          <ul id="a705da44-153e-4217-bf53-7881fbc69975" class="bulleted-list">
            <li>Po odečtení jednotky (cca 1minuta) proběhne autentizace</li>
          </ul>
          <ul id="75426382-ab26-4162-934b-584957a5a753" class="bulleted-list">
            <li>Po každém vytáhnutí karty potřebuje automat cca 5-10s na restart</li>
          </ul>
        </li>
      </ul>
      <ul id="e516484f-7f62-4366-a427-5267867f48fd" class="bulleted-list">
        <li>Nutnost připojit k sběrnému zařízení paměť (notebook?)</li>
      </ul>
      <ul id="55400fe3-c571-4ef7-8e77-dc7188753eda" class="bulleted-list">
        <li>Nutnost přítomnosti operátora, který bude kartu vytahovat a vkládat</li>
      </ul>
      <h3 id="e0ed6425-f710-48df-bcc1-6e6ed01e9d79" class="">Inspirace</h3>
      <p id="593ab294-e478-45a5-a14a-6032a2a5d61e" class="">Několik zajmavých fotek:</p>
      <ul id="9c340b52-d3cd-4819-b43f-bb5114670938" class="bulleted-list">
        <li>
          <a href="http://ciscom.ru/hackersrussia/Cards/Syncro/Fotos/Fotos.php">http://ciscom.ru/hackersrussia/Cards/Syncro/Fotos/Fotos.php</a>
        </li>
      </ul>
      <h2 id="62b9cfaf-3d39-412a-86c8-587548449db9" class="">Reverzní inženýrství automatu</h2>
      <p id="faf0790e-7b38-4325-a016-7403928c84df" class="">Jednalo by se o ukradení automatu a jeho pitvání a zkoumání, hledání dat v pamětech, zjišťování ochran a v konečném důsledku i o možnost provádět MITM odposlech mezi kartou a automatem doma.</p>
      <h3 id="590a442c-8329-4b7f-8c55-774049390498" class="">Výhody</h3>
      <ul id="3bcc6dfd-b513-45f2-a4e2-cb299031f5f7" class="bulleted-list">
        <li>Rychlost MITM
          <ul id="f6f0e5db-fed8-4a19-a6c5-b59d1c049df9" class="bulleted-list">
            <li>MITM se zrychlí, pokud zde bude možnost provádět odposlouchávání nerušeně např. celou noc</li>
          </ul>
        </li>
      </ul>
      <ul id="c61523b2-fd85-4af7-ae19-d73db5f7cf4a" class="bulleted-list">
        <li>Možnost nalezení snadnějšího způsobu získávání dat
          <ul id="a767386d-cc6e-4dce-8e65-217743a15152" class="bulleted-list">
            <li>V automatu může být čip, který provádí hashování dat - jeho zkoumáním by se možná dal algoritmus odhalit</li>
          </ul>
          <ul id="7c497c2c-335c-41db-85d3-fcf2a369a0ff" class="bulleted-list">
            <li>Pokud čip vyexportuji na vlastní desku, nebudu muset čekat na reset automatu - toto má vliv pouze při získávándat pomocí MITM útoku</li>
          </ul>
        </li>
      </ul>
      <ul id="61e79213-ace5-407b-bc15-8982008e31b7" class="bulleted-list">
        <li>Možnost využívat šifrovací čip v emulátoru
          <ul id="e16558f3-ed09-4490-b96d-9c4675bf8f1d" class="bulleted-list">
            <li>Z některých ruských stránek vyplývá, že šifrovací čip a paměť se dá používat jako emulátor</li>
          </ul>
        </li>
      </ul>
      <h3 id="cbfc3e3b-2700-4d63-b262-d793feab0c05" class="">Nevýhody</h3>
      <ul id="a4288baa-2797-42f0-b10d-121b4ef6831b" class="bulleted-list">
        <li>Nutnost ukrást automat
          <ul id="f83a58e0-549b-4518-bd99-aa543bdaf701" class="bulleted-list">
            <li>Muže to byt špatně proveditelné</li>
          </ul>
          <ul id="03424535-5005-4a83-9fc0-7a12811726f3" class="bulleted-list">
            <li>Můžou Vás udat náhodní svědci</li>
          </ul>
          <ul id="a9ef0e30-a0e4-4546-a86b-ad231d4180b0" class="bulleted-list">
            <li>Ukradeného automatu si každý všimne, doma ho jen tak neschováte</li>
          </ul>
        </li>
      </ul>
      <ul id="1d8943d0-896c-4804-8dbf-5c652d21c0c0" class="bulleted-list">
        <li>Možnost zranění při krádeži (v automatu je 230V)</li>
      </ul>
      <ul id="917148de-f8c6-462a-946e-8cfa4cd81a03" class="bulleted-list">
        <li>V konečném důsledku to může být k ničemu</li>
      </ul>
      <h1 id="9d5c04cc-5749-4bd1-8ce9-ec92648664c0" class="">Reverzní inženýrství karty</h1>
      <h2 id="c90460df-a04b-42ed-b645-7db89c4729a7" class="">Falešný automat</h2>
      <p id="710bde50-2345-4683-9b04-fda1f66621d3" class="">V podstatě se jedná o postavení přípravku, který se bude tvářit jako automat. Pokud bude kartě posílat náhodná čísla, může výsledky hash funkce ukládat pro pozdější bruteforce útok do počítače, čímž odpadne nutnost stavět MITM sniffer.</p>
      <h3 id="3e116838-60bc-4898-a49e-2334026ac2ab" class="">Výhody</h3>
      <ul id="222dbc3b-ac4e-4c0f-ac3c-247425708f92" class="bulleted-list">
        <li>Velmi nízké náklady</li>
      </ul>
      <ul id="004732d5-6964-441e-b8e5-bef25e312008" class="bulleted-list">
        <li>Vysoká rychlost získávání odpovědí (počítám že několik za sekundu)</li>
      </ul>
      <ul id="93d3094d-3aea-49db-a2a8-be9d4a6554fb" class="bulleted-list">
        <li>Nenápadnost (kartu a čtečku doma schováte spíš než rozpitvaný automat)</li>
      </ul>
      <h3 id="4ba9f7b4-5f07-44e7-9627-ab01848b495c" class="">Nevýhody</h3>
      <ul id="7ceaf907-1531-4ba6-9672-3c752b8372a2" class="bulleted-list">
        <li>V podstatě žádné</li>
      </ul>
      <h2 id="9c843b24-6d2b-45f7-acf6-f76ce6f1426f" class="">Útok na hardware karty</h2>
      <ul id="bb823183-1465-4272-9644-071ec49e2061" class="bulleted-list">
        <li>
          <strong>Aktivní průzkum</strong>
          <ul id="4648d813-7d94-4f4f-b9b8-c4dbb2a67429" class="bulleted-list">
            <li>Jedná se o odleptání krycí vrstvy čipu a průzkum jeho struktury</li>
          </ul>
          <ul id="7123ecf4-4910-4f8c-a2e2-02d25c79f5bf" class="bulleted-list">
            <li>Při tomto postupu je možné přímo přečíst paměti typu (P)ROM</li>
          </ul>
          <ul id="7f6ffc64-d3f0-4266-9c19-b7b6b9f9855b" class="bulleted-list">
            <li>Je možné zasahovat do chodu karty, popřípadě odposlouchávat jednotlivé části čipu</li>
          </ul>
          <ul id="2551fa79-06e4-4c14-bdd0-3cf15786d029" class="bulleted-list">
            <li>Inspirace
              <ul id="424de051-9fc3-454c-b7be-8e4e99c0ddb8" class="bulleted-list">
                <li>
                  <a href="http://web.archive.org/web/20080612172433/www.flylogic.net/blog/?p=26">http://web.archive.org/web/20080612172433/www.flylogic.net/blog/?p=26</a>
                </li>
              </ul>
              <ul id="1831dd49-1199-416b-9ef1-4edb6deda27e" class="bulleted-list">
                <li>
                  <a href="http://microblog.routed.net/2008/07/15/how-to-write-an-ic-friday-post/">http://microblog.routed.net/2008/07/15/how-to-write-an-ic-friday-post/</a>
                </li>
              </ul>
              <ul id="99bd0fd0-6ac7-4f98-a2ec-a1632a659a50" class="bulleted-list">
                <li>
                  <a href="http://www.wired.com/politics/security/news/2008/05/tarnovsky">http://www.wired.com/politics/security/news/2008/05/tarnovsky</a> (video)
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
      <ul id="79248de5-c4c1-4236-beba-dc3ed619086c" class="bulleted-list">
        <li>
          <strong>Pasivní průzkum</strong>
          <ul id="94e87058-a864-46fc-9dcb-d2c70462c370" class="bulleted-list">
            <li>V podstatě jde o snahu prozkoumat strukturu karty pomocí např. rentgenového záření, nebo terahertzové kamery, či nějakého podobného neinvazivního prostředku</li>
          </ul>
          <ul id="18d81f58-7e0d-4e28-ba78-170caa31660b" class="bulleted-list">
            <li>Za předpokladu že se program nachází v (P)ROM by neměl být problém ho přečíst</li>
          </ul>
          <ul id="96a5d1b9-2ca0-4901-87f0-d1b38b5df4a0" class="bulleted-list">
            <li>Bohužel, zdá se že rentgenový mikroskop se moc nepoužívá (místo něj použít elektronový mikroskop?)</li>
          </ul>
          <ul id="2cf30bd5-2e78-4397-91cd-d68a7aee3426" class="bulleted-list">
            <li>Nestačil by místo mikroskopu (soustavy zaostřovacích čoček) pouze hodně citlivý film?</li>
          </ul>
          <ul id="9241137b-1f02-4cfa-b791-00c3a2faa8c2" class="bulleted-list">
            <li>Inspirace
              <ul id="e90b550d-4139-485f-9238-f8d1996915b2" class="bulleted-list">
                <li>
                  <a href="http://www.bunniestudios.com/blog/?p=692">http://www.bunniestudios.com/blog/?p=692</a>
                </li>
              </ul>
              <ul id="0a401903-9947-464e-80df-c6b6ad2b73f8" class="bulleted-list">
                <li>
                  <a href="http://www.danyk.wz.cz/rtg7.html">http://www.danyk.wz.cz/rtg7.html</a>
                </li>
              </ul>
              <ul id="bf1ac2af-7090-4a24-82b5-3a8ab2e9b868" class="bulleted-list">
                <li>
                  <a href="http://www.ualberta.ca/~mingchen/chip.htm">http://www.ualberta.ca/~mingchen/chip.htm</a>
                </li>
              </ul>
              <ul id="58920a42-46b4-448f-8685-81bb027682cf" class="bulleted-list">
                <li>
                  <a href="http://www.assurancetechnology.com/FA1.asp">http://www.assurancetechnology.com/FA1.asp</a>
                </li>
              </ul>
              <ul id="78cb20fb-b9af-4149-ab7f-4f001546b83b" class="bulleted-list">
                <li>
                  <a href="http://www.bgtu.net/">http://www.bgtu.net/</a>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
      <h3 id="9f2f524c-3c6c-4e43-8976-7d82f9893a86" class="">Výhody</h3>
      <ul id="8a102630-adb2-4c24-a3ea-319f035b2fdc" class="bulleted-list">
        <li>Získání algoritmu tak jak je na kartě uložen</li>
      </ul>
      <ul id="f57f3af7-a0b7-4b81-baa9-1a16c5aa67f5" class="bulleted-list">
        <li>Možnost manipulace s čipem, získání zajímavých obrázku :)</li>
      </ul>
      <h3 id="61958864-707d-4525-9874-708d80d5a4f7" class="">Nevýhody</h3>
      <ul id="2aa8a576-aff1-417c-8b96-caba9d283081" class="bulleted-list">
        <li>Nutnost přístupu do pokročilé laboratoře</li>
      </ul>
      <ul id="a1418929-b34c-49c2-abd7-02fc9a26b90f" class="bulleted-list">
        <li>Nutnost získat potřebné toxické látky, nebo rentgen</li>
      </ul>
      <ul id="4e312e8e-fe5a-4a89-9c6c-803b26bea40c" class="bulleted-list">
        <li>Znalost práce s prudce jedovatými látkami</li>
      </ul>
      <ul id="2772276c-4adc-4377-a5e4-c556746a76dd" class="bulleted-list">
        <li>Nutnost zkušeností s podobnou prací</li>
      </ul>
      <h1 id="8473d935-703d-4f29-a493-f38f30b5e6db" class="">Získání algoritmu z nasbíraných dat</h1>
      <p id="28bd084f-f4ee-4823-b7a6-10d970fe1879" class="">Z <a href="http://www.ciscom.ru/hackersrussia/Cards/Syncro/Eurochip.txt">jistých zdrojů</a> vyplývá, že algoritmus je založen na hardwarových funkcích procesoru, přičemž by měl využívat <strong>48b</strong> <a href="http://cs.wikipedia.org/wiki/Posuvn%C3%BD_registr">posuvný registr</a>, <a href="http://cs.wikipedia.org/wiki/Exkluzivn%C3%AD_disjunkce">XOR</a> a <strong>NXOR</strong>. Procesor také obsahuje tři <strong>9b</strong>, <strong>6b</strong> a <strong>5b</strong> <a href="http://cs.wikipedia.org/wiki/%C4%8C%C3%ADta%C4%8D">čítače</a> s neznámou funkcí. Dále existuje nezanedbatelná pravděpodobnost, že se algoritmus podobá výpočtu <a href="http://www.ross.net/crc/download/crc_v3.txt">CRC</a>.</p>
      <p id="a59395ec-c6fa-4743-a19e-b47c03a6f8b8" class="">Článek na <a href="http://hw.cz/">hw.cz</a> se zmiňuje, že pro získání jednoho bitu hashe je nutné poslat kartě 160x CLK pulz. Z toho vyplývá, že algoritmus probíhá sekvenčně pro každý bit zvlášť a je teoreticky tvořen max. 160 instrukcemi.</p>
      <ul id="77547e37-7cd5-425a-b67a-d13a96ff0bd4" class="bulleted-list">
        <li>
          <a href="http://ciscom.ru/hackersrussia/Cards/Syncro/Algoritm.php">http://ciscom.ru/hackersrussia/Cards/Syncro/Algoritm.php</a> (<a href="http://translate.google.com/translate?hl=cs&amp;sl=ru&amp;tl=cs&amp;u=http%3A%2F%2Fciscom.ru%2Fhackersrussia%2FCards%2FSyncro%2FAlgoritm.php">google translator</a>)
        </li>
      </ul>
      <p id="75f994cb-5ffd-43d4-a3e2-766b8ea19d62" class="">Z výše uvedeného vyplývá, že algoritmus by měl vypadat nějak takhle:</p>
      <figure id="5ca005c3-c4ff-4104-95b3-1c8992a62391" class="image">
        <a href="drawing_seT-uCA2crHUT848MxtJMeg_328.png" title="drawing_seT-uCA2crHUT848MxtJMeg_328.png"><img style="width:600px" src="drawing_seT-uCA2crHUT848MxtJMeg_328.png"></a>
      </figure>
      <h2 id="d1b5fca9-24f8-488b-8990-fe7b4746cb9a" class="">Možnosti rekonstrukce algoritmu</h2>
      <p id="931a24d4-4083-4111-afea-ec764cbede50" class="">Podle mě v úvahu připadají pouze tyto dvě techniky:</p>
      <ul id="049dd85f-78a7-4884-9d97-8a37d9dbfac0" class="bulleted-list">
        <li>Matematická analýza
          <ul id="5e9560d5-0c63-4320-8622-27c79ce7799f" class="bulleted-list">
            <li>K uskutečnění je zapotřebí kryptoanalytik s hlubokými znalostmi matematiky.</li>
          </ul>
          <ul id="6a89820b-cc58-4b6c-883b-9d6ff131c5df" class="bulleted-list">
            <li>Nevýhoda; schopní kryptoanalytici se poněkud těžko shánějí.</li>
          </ul>
        </li>
      </ul>
      <ul id="de66ce57-5ead-40ae-a5cd-1bc3cf716254" class="bulleted-list">
        <li>
          <a href="http://cs.wikipedia.org/wiki/%C3%9Atok_hrubou_silou">Hrubá síla</a>
          <ul id="45d04c26-e540-411a-a967-b315dec28c70" class="bulleted-list">
            <li>Jelikož má mikročip velice malý výkon, troufám si předpokládat že algoritmus nebude moc dlouhý, protože i velikost paměti pro program bude relativně malá.</li>
          </ul>
          <ul id="43cd17c6-b504-4f35-92fd-8ca6347ec141" class="bulleted-list">
            <li>Algoritmus potřebuje pro výpočet jednoho z 16b hashe <strong>160 CLK pulzů</strong>, což znamená že program by měl obsahovat <strong>max. 160 instrukcí</strong>.
              <ul id="5d4dad08-ef08-4b8c-9009-8fa013b0bbc0" class="bulleted-list">
                <li>Je ovšem nutné brát v úvahu že některé operace mohou potřebovat více CLK pulzů pro jeden výsledek, takže to v konečném důsledku může být i méně.</li>
              </ul>
              <ul id="18452489-f8c6-475f-b276-177a1a8ae01f" class="bulleted-list">
                <li>Na druhou stranu některé operace (jako je třeba inkrementace čítače) mohou probíhat zároveň s ostatními instrukcemi, takže vlastně proběhne více primitivních operací než 160. Tento fakt bude nutné zohlednit při návrhu crackeru.</li>
              </ul>
            </li>
          </ul>
          <ul id="b4ef13e6-7a68-4944-8580-6e98b448a23f" class="bulleted-list">
            <li>K útoku je zapotřebí průměrný programátor a velký výkon, což by v dnešní době neměl být takový problém, obzvlášť pokud se využije paralelizace.</li>
          </ul>
        </li>
      </ul>
      <p id="6a10e09b-c49c-4032-a790-436835c4d95f" class="">Jelikož první volba je poněkud mimo možnosti běžného geeka, myslím že útok hrubou silou bude muset stačit.</p>
      <h2 id="ee27f1dc-6f8f-47a4-98ae-9117f03bf71e" class="">Bruteforce cracker</h2>
      <p id="8ebc5feb-037a-4d88-8dcd-bb0c6829b305" class="">Útok hrubou silou by měl být značně zjednodušený, protože známe vstup, výstup, přibližný počet instrukcí a navíc víme které operace nejspíš algoritmus generování hashe využívá a které ne. Jediné co zbývá je napsat program, který se pokusí odhalit v jakém pořadí jsou operace aplikovány, čímž odhalí algoritmus a umožní stavbu emulátoru.</p>
      <p id="ebc322a9-b68c-453e-9952-00697d9b3774" class="">Cracker by měl dle mého názoru vypadat přibližně takto:</p>
      <figure id="f26d91c5-f770-4f06-aaf2-ffd06d4b5ab5" class="image">
        <a href="drawing_sz04u9KlXrXtxLxwQ3wJ_VA_353.png" title="drawing_sz04u9KlXrXtxLxwQ3wJ_VA_353.png"><img style="width:600px" src="drawing_sz04u9KlXrXtxLxwQ3wJ_VA_353.png"></a>
      </figure>
      <h3 id="0f2f77ff-8121-4b92-a20e-20af320760f9" class="">Popis crackeru</h3>
      <ul id="083b222b-be65-4c9b-8cd4-a698f64c5c07" class="bulleted-list">
        <li>Ze souboru se načte zachycený <strong>obsah karty</strong>, <strong>náhodné číslo</strong> a výsledný <strong>hash</strong>.</li>
      </ul>
      <ul id="0afdb760-99ef-4a67-8a11-36029b3f7167" class="bulleted-list">
        <li><strong>Permutátor</strong> vygeneruje <strong>posloupnost instrukcí</strong>, kterou odešle <strong>interpreteru</strong>.</li>
      </ul>
      <ul id="698a9a06-8a14-4479-8c31-b8112530d444" class="bulleted-list">
        <li><strong>Interpreter</strong> postupně vykonává <strong>instrukce</strong>, v registrech nebo paměti má uložen <strong>zachycený obsah karty</strong> a <strong>náhodné číslo</strong>.</li>
      </ul>
      <ul id="e78898eb-1963-4495-ae6d-9d38aa5956bc" class="bulleted-list">
        <li>Výstupu z <strong>interpreteru</strong> je změřena velikost - pokud se nerovná <strong>16b</strong>, postupuje se rovnou k další iteraci.</li>
      </ul>
      <ul id="0de24789-8a6d-4fce-958c-5757fd389639" class="bulleted-list">
        <li>Pokud <strong>hash</strong> prošel testem na velikost, porovná se s <strong>zaznamenaným hashem</strong>. Pokud jsou hashe stejné, <strong>aktuální posloupnost instrukcí</strong> se uloží do <strong>logu</strong> a načte se další zaznamenaný hash, obsah karty a náhodné číslo, na které se aplikuje stejná posloupnost instrukcí.
          <ul id="518ce8e6-aadb-4f5d-a2b0-e2e9a35cb380" class="bulleted-list">
            <li>Pokud hash vyhoví i nyní, můžeme předchozí krok opakovat, nebo instrukce zapsat do souboru a prohlásit že <strong>algoritmus byl prolomen</strong>.</li>
          </ul>
        </li>
      </ul>
      <ul id="da18068a-da29-42b4-b769-39936aca38ab" class="bulleted-list">
        <li>Pokud neprojde porovnáním se zaznamenaným <strong>hashem</strong>, pošleme <strong>permutátoru</strong> signál k vygenerování <strong>nové sekvence</strong> a celý postup se opakuje.</li>
      </ul>
      <p id="125a9f7d-6aaa-46aa-b6a3-9a50c0ee94f6" class="">Do crackeru by možná bylo dobré zabudovat <a href="http://cs.wikipedia.org/wiki/Genetick%C3%A9_algoritmy">genetické algoritmy</a>, ale jelikož se v nich moc nevyznám, netuším jak moc by jejich implementace byla v tomto případě vhodná.</p>
      <h1 id="2e5e38c4-3747-4d07-b624-e0f3eefb7c0b" class="">Závěr</h1>
      <p id="edb3e481-9e59-4605-8736-cce4ffcd7197" class="">Nakonec bych chtěl ještě zdůraznit že tento článek není dokonalý, já nejsem dokonalý, dokonce nejsem ani odborník na mikroprocesory nebo zabezpečení karet a proto zde existuje poměrně slušná pravděpodobnost že článek obsahuje chyby nebo nepřesnosti. Je možné že některé metody a možnosti které jsem popsal jsou nesmyslné, nebo nefunkční.</p>
      <p id="b1bbe9f2-c83d-4460-9ce6-c658b0b51ffc" class="">Tento článek neměl a nemá sloužit jako návod, ale k podnícení diskuze nad popsanými metodami. Pokud někoho napadne nějaká připomínka nebo věcná kritika, budu rád když jí uvede v diskuzi k článku, nebo mi jí pošle jinou cestou.</p>
      <h1 id="5d66e8ac-9179-4c48-9eda-97ad5878522d" class="">Zdroje</h1>
      <p id="d3b785ea-e1a3-419f-9017-c8ef98211a66" class=""></p>
      <ul id="771e7b35-d329-476a-9143-da48cdab1809" class="bulleted-list">
        <li>
          <a href="http://hw.cz/Teorie-a-praxe/Navrhy-vyvojare/ART1444-Slovenske-telefonne-karty-po-druhe.html">http://hw.cz/Teorie-a-praxe/Navrhy-vyvojare/ART1444-Slovenske-telefonne-karty-po-druhe.html</a>
        </li>
      </ul>
      <ul id="3be765cb-2670-45c1-b3ea-8dca0a62f178" class="bulleted-list">
        <li>
          <a href="http://gsho.thur.de/gsho/phonecard/advanced_e.htm">http://gsho.thur.de/gsho/phonecard/advanced_e.htm</a>
        </li>
      </ul>
      <ul id="2e258ccc-61c8-4e22-b1ca-aad6e6340842" class="bulleted-list">
        <li>
          <a href="http://gsho.thur.de/gsho/phonecard/bin/phonecards_204.txt">http://gsho.thur.de/gsho/phonecard/bin/phonecards_204.txt</a>
        </li>
      </ul>
      <ul id="ebff4744-69a8-4c3d-ab55-799d02b36f27" class="bulleted-list">
        <li>
          <a href="http://www.ciscom.ru/hackersrussia/Cards/Syncro/Eurochip.txt">http://www.ciscom.ru/hackersrussia/Cards/Syncro/Eurochip.txt</a>
        </li>
      </ul>
      <p id="824a1280-92c8-4e4b-9a09-a4dc4a597dfc" class=""></p>
    </div>
  </article>
  <div class="corner-ribbon top-right red">
    <a href="https://www.patreon.com/bePatron?u=2618881">Become a Patron</a>
  </div><a class="twitter-share-button" id="twitter_button" href="#"><img src="../../../tweet_button.svg"></a>
  <div id="sidebar_bottom">
    <div id="last_five_bottom">
      <h3>New posts:</h3>
      <ul>
        <li>
          <a href="https://blog.rfox.eu/atom_cz.xml">Vytvořen nový Atom (RSS) feed pro českou sekci</a>
        </li>
      </ul>
    </div>
  </div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8322439660353685" data-ad-slot="4657737295" data-ad-format="auto" data-full-width-responsive="true"></ins> 
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script> 
  <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false">
  </script> 
  <script>
  window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#edeff5",
      "text": "#838391"
    },
    "button": {
      "background": "#4b81e8"
    }
  }
  });
  </script>
</body>
</html>
