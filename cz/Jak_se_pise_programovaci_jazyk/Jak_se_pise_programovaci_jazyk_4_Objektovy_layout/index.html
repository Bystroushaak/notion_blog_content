<!DOCTYPE html>
<html>
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.2.0">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Jak se pÃ­Å¡e programovacÃ­ jazyk 4: ObjektovÃ½ layout</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css">
  <link rel="alternate" type="application/atom+xml" href="http://blog.rfox.eu/atom.xml">
  <link rel="shortcut icon" href="/favicon.ico"><!-- Global site tag (gtag.js) - Google Analytics -->

  <script src="https://www.googletagmanager.com/gtag/js?id=UA-142545439-1">
  </script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-142545439-1');
  </script>
  <script data-ad-client="ca-pub-8322439660353685" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async>
  </script>
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@Bystroushaak">
  <meta name="twitter:creator" content="@Bystroushaak">
  <meta name="twitter:title" content="Jak se pÃ­Å¡e programovacÃ­ jazyk 4: ObjektovÃ½ layout">
  <meta name="twitter:description" content="DalÅ¡Ã­m logickÃ½m krokem by mÄ›lo bÃ½t vytvoÅ™enÃ­ virtuÃ¡lnÃ­ho stroje, kterÃ½ bude programovacÃ­ jazyk interpretovat, a kompilÃ¡toru, kterÃ½ pro tento virtuÃ¡lnÃ­ stroj zkompiluje zdrojovÃ½ kÃ³d. PÅ™ed tÃ­m, neÅ¾ se do toho mÅ¯Å¾u pustit je vÅ¡ak tÅ™eba ujasnit si, nejlÃ©pe formou konkrÃ©tnÃ­ implementace, jak bude vypadat reprezentace a rozloÅ¾enÃ­ objektÅ¯ v pamÄ›ti.">
  <meta name="twitter:image" content="http://blog.rfox.eu/cz/Jak_se_pise_programovaci_jazyk/Jak_se_pise_programovaci_jazyk_4_Objektovy_layout/map_0.png">
  <script src="../../../scripts.js">
  </script>
  <meta name="description" content="DalÅ¡Ã­m logickÃ½m krokem by mÄ›lo bÃ½t vytvoÅ™enÃ­ virtuÃ¡lnÃ­ho stroje, kterÃ½ bude programovacÃ­ jazyk interpretovat, a kompilÃ¡toru, kterÃ½ pro tento virtuÃ¡lnÃ­ stroj zkompiluje zdrojovÃ½ kÃ³d. PÅ™ed tÃ­m, neÅ¾ se do toho mÅ¯Å¾u pustit je vÅ¡ak tÅ™eba ujasnit si, nejlÃ©pe formou konkrÃ©tnÃ­ implementace, jak bude vypadat reprezentace a rozloÅ¾enÃ­ objektÅ¯ v pamÄ›ti.">
</head>
<body onload="on_body_load();">
  <div id="sidebar_top">
    <div id="last_five_top">
      <h3>New posts:</h3>
      <ul>
        <li>
          <a href="../../../en/Weekly_updates/Lifelog_2020-06-15_Todo_in_motion.html" title="Lifelog 2020-06-15; Todo in motion">Lifelog 2020-06-15; Todo in motion</a>
        </li>
        <li>
          <a href="../../../en/My_Greenspuns_counter.html" title="My Greenspun's counter">My Greenspun's counter</a>
        </li>
        <li>
          <a href="../../../en/About_this_blog/What_do_I_mean_by_node.html" title="What do I mean by node?">What do I mean by node?</a>
        </li>
        <li>
          <a href="../../../en/Explorations/Trying_Ansible_alternatives_in_python.html" title="Trying Ansible alternatives in python">Trying Ansible alternatives in python</a>
        </li>
        <li>
          <a href="../../../en/Improvements/The_Most_Personal_Device_experiment/Pebble_smartwatches.html" title="Pebble smartwatches">Pebble smartwatches</a>
        </li>
        <li>
          <a href="../../../en/Improvements/The_Most_Personal_Device_experiment.html" title="The Most Personal Device experiment"><span class="icon">ğŸ“‚</span>The Most Personal Device experiment</a>
        </li>
        <li>
          <a href="../../../en/About_this_blog/Unicode_font_subset.html" title="Unicode font subset">Unicode font subset</a>
        </li>
        <li>
          <a href="../../../en/Weekly_updates/Lifelog_2020-05-25_Work_in_progress_everywhere.html" title="Lifelog 2020-05-25; Work in progress everywhere">Lifelog 2020-05-25; Work in progress everywhere</a>
        </li>
        <li>
          <a href="http://blog.rfox.eu/en/Improvements/Vitamins_nootropics_and_other_boosters.html">Vitamins, nootropics and other boosters</a>
        </li>
        <li>
          <a href="http://blog.rfox.eu/en/objWiki/Transaction_support_for_simple_in_memory_database.html">Transaction support for simple in-memory database</a>
        </li>
      </ul>& <a href="../../../Changelog.html" title="Changelog">more</a>
    </div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8322439660353685" data-ad-slot="8589969791" data-ad-format="auto" data-full-width-responsive="true"></ins> 
    <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div><a class="breadcrumb" href="../../../index.html" title="Bystroushaak's blog">Bystroushaak's blog</a> / <a class="breadcrumb" href="../../index.html" title="Czech section">Czech section</a> / <a class="breadcrumb" href="../index.html" title="Jak se pÃ­Å¡e programovacÃ­ jazyk">Jak se pÃ­Å¡e programovacÃ­ jazyk</a> / Jak se pÃ­Å¡e programovacÃ­ jazyk 4: ObjektovÃ½ layout <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8322439660353685" data-ad-slot="9175281399" data-ad-format="auto" data-full-width-responsive="true"></ins> 
  <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  <article id="6f84fd21-f69e-4275-9575-d0c20719bc2c" class="page sans">
    <header>
      <h1 class="page-title">Jak se pÃ­Å¡e programovacÃ­ jazyk 4: ObjektovÃ½ layout</h1>
    </header>
    <div class="page-body">
      <p id="ff814f60-f037-4789-9846-3bb68ae5d7ce" class=""><time>@2019/03/13</time></p>
      <p id="3c97b191-83e4-49fb-a500-e28593b736d7" class="">DalÅ¡Ã­m logickÃ½m krokem by mÄ›lo bÃ½t vytvoÅ™enÃ­ virtuÃ¡lnÃ­ho stroje, kterÃ½ bude programovacÃ­ jazyk interpretovat, a kompilÃ¡toru, kterÃ½ pro tento virtuÃ¡lnÃ­ stroj zkompiluje zdrojovÃ½ kÃ³d. PÅ™ed tÃ­m, neÅ¾ se do toho mÅ¯Å¾u pustit je vÅ¡ak tÅ™eba ujasnit si, nejlÃ©pe formou konkrÃ©tnÃ­ implementace, jak bude vypadat reprezentace a rozloÅ¾enÃ­ objektÅ¯ v pamÄ›ti.</p>
      <p id="69dedfef-c946-4724-9bb3-516e368f5a20" class="">Specificky nÃ¡sledujÃ­cÃ­ vÄ›ci;</p>
      <ol id="9155f3b2-42f6-4559-8cbc-f2f93fa5d27d" class="numbered-list" start="1">
        <li>Jak budou objekty reprezentovÃ¡ny.</li>
      </ol>
      <ol id="b97f8cf4-920f-4249-a8a8-cb47438729ef" class="numbered-list" start="2">
        <li>Kde a jak budou umÃ­stÄ›ny.</li>
      </ol>
      <ol id="3e16d8b4-2faa-4729-abfb-9427d888d47e" class="numbered-list" start="3">
        <li>Jak se s tÃ­m vÅ¡Ã­m bude pracovat.</li>
      </ol>
      <h2 id="4b4efd67-d705-4425-a5bb-519ad6ae7738" class="">SelfovÃ© objekty</h2>
      <p id="ec0483e5-557d-4c16-9ab9-f2a2c1a5d30e" class="">PÅ™estoÅ¾e tento seriÃ¡l je urÄen pÅ™edevÅ¡Ã­m pro pokroÄilÃ© ÄtenÃ¡Å™e, od kterÃ½ch oÄekÃ¡vÃ¡m alespoÅˆ zÃ¡kladnÃ­ obeznÃ¡menÃ­ se Selfem, pro jistotu zde rekapituluji na prototypech zaloÅ¾enÃ½ objektovÃ½ model Selfu.</p>
      <p id="1fa9ce87-436a-4db9-b7bd-21c580e5fd6c" class="">Objekty v Selfu se chovajÃ­ jako asociativnÃ­ pole, kterÃ© na <em>konkrÃ©tnÃ­m jmÃ©nu</em> uchovÃ¡vajÃ­ buÄto hodnotu, nebo odkaz na jinÃ© objekty. PÃ¡r <em>jmÃ©no : hodnota</em> je nazÃ½vÃ¡n slotem. Objekt je kolekcÃ­ takovÃ½chto slotÅ¯.</p>
      <pre id="add733ae-d6d7-4ef8-bca4-530e966daaa7" class="code"><code>(| slot = 1. another = 2 |)</code></pre>
      <p id="db60b715-6fc2-4f5d-bd65-82dc99ee5367" class="">Tento objekt na jistÃ© Ãºrovni abstrakce odpovÃ­dÃ¡ slovnÃ­ku <code>{"slot": 1, "another": 2}</code>.</p>
      <p id="3e914551-dd37-48c1-b37b-fd153d3d82fd" class="">KlÃ­Äe v asociativnÃ­m poli jsou pÅ™eloÅ¾eny na konkrÃ©tnÃ­ vÃ½sledek aktem <em>poslÃ¡nÃ­ zprÃ¡vy objektu</em>. ZprÃ¡vy mÅ¯Å¾ou bÃ½t unÃ¡rnÃ­ (jednoduchÃ½ string bez mezer), binÃ¡rnÃ­ (operÃ¡tory jako +-*/ a tak podobnÄ›), Äi <em>keyword</em> (sloÅ¾enÃ© z jednoho, Äi vÃ­ce klÃ­ÄovÃ½ch slov nÃ¡sledovanÃ½ch dvojteÄkou).</p>
      <pre id="c7112f8d-5842-429a-99b4-ba53d08a4ea3" class="code"><code>obj unaryMessage.
obj + anotherObj.
obj keyword: anotherObj Message: evenMoreObjs.</code></pre>
      <p id="50565fb8-f379-4d9e-bae0-150abd4c706f" class="">Analogie k pythonu by byla:</p>
      <pre id="b7f4e113-bbea-4c19-9aae-ecf44967316d" class="code"><code>obj.unaryMessage()
obj.+(anotherObj)
obj.keyword:Message:(anotherObj, evenMoreObjs)</code></pre>
      <p id="3237f48e-feee-4440-96d4-216564a85f90" class="">RozdÃ­ly oproti klasickÃ©mu asociativnÃ­mu poli jsou nÃ¡sledujÃ­cÃ­:</p>
      <ul id="908de3d7-f12b-4384-a532-86827b550770" class="bulleted-list">
        <li>Pokud je vÃ½sledkem pÅ™eloÅ¾enÃ­ zprÃ¡vy na slot objekt <em>obsahujÃ­cÃ­ kÃ³d</em>, je spuÅ¡tÄ›n v kontextu volanÃ©ho objektu a jsou mu pÅ™edÃ¡ny patÅ™iÄnÃ© parametry.</li>
      </ul>
      <ul id="3ab23c08-d31a-4a67-837a-f1888fedd8cb" class="bulleted-list">
        <li>Pokud nenÃ­ slot v objektu nalezen, objekt mÃ¡ moÅ¾nost na to reagovat.</li>
      </ul>
      <ul id="bfe9c50b-9436-44ba-8389-b7709930ed1e" class="bulleted-list">
        <li>Pokud objekt definuje rodiÄovskÃ½ slot, je hledÃ¡nÃ­ slotu pÅ™i neÃºspÄ›chu pÅ™eneseno do nÄ›j. TÃ­m je Å™eÅ¡ena delegace ve stylu dÄ›diÄnosti.</li>
      </ul>
      <p id="fe2a8bb2-8dcb-4283-8e49-f293a13c679d" class="">Objekt je moÅ¾nÃ© internÄ› reprezentovat tÅ™Ã­dou zhruba a velmi abstraktnÄ› nÃ¡sledujÃ­cÃ­ho typu:</p>
      <pre id="19297d00-31ee-4b01-8343-dc426a3c5284" class="code"><code>class Object:
    def __init__(self):
        self.slots = {}
        self.parents = {}

        self.scope_parent = None
        self.primitive_code = None
        self.parameters = []</code></pre>
      <p id="176507ec-31da-40ac-9db7-029b061d5c36" class="">Tedy <code>Objekt</code> mÅ¯Å¾e obsahovat sloty jako hashmapu, seznam pÅ™ijÃ­manÃ½ch parametrÅ¯ jako pole, slovnÃ­k odkazÅ¯ na rodiÄe a kÃ³d, coÅ¾ je zase jinÃ½ objekt, nÄ›co jako pole zprÃ¡v, kterÃ© se postupnÄ› zasÃ­lajÃ­.</p>
      <p id="00fd8bd5-e66a-4d14-b5a5-ffe0231bc73d" class="">Od zaÄÃ¡tku jsem chtÄ›l, aby sloty byly uloÅ¾eny se zachovÃ¡nÃ­m poÅ™adÃ­ v <code>OrderedDictu</code>, mÃ­sto v klasickÃ© hashmapÄ›. To nenÃ­ tak moc podstatnÃ©, pro samotnÃ½ programovacÃ­ jazyk, jako pro jeho vyuÅ¾itÃ­ k uklÃ¡dÃ¡nÃ­ strukturovanÃ½ch informacÃ­. DÃ­ky tomu je moÅ¾nÃ© do stromovÃ© struktury napÅ™Ã­klad 1:1 konvertovat XML s pomÄ›rnÄ› malÃ½m <em>overheadem</em>.</p>
      <h2 id="a31d5c15-6c70-4d0f-b50b-06fcb0a2f1bf" class="">Reprezentace objektÅ¯</h2>
      <p id="1f44eda6-641d-48de-bbb1-539867442b28" class="">V na tÅ™Ã­dÃ¡ch zaloÅ¾enÃ½ch jazycÃ­ch jsou objekty reprezentovÃ¡ny pÅ™ibliÅ¾nÄ› nÄ›jak jako pointer na tÅ™Ã­du nÃ¡sledovanÃ½ polem s datovÃ½mi sloty udrÅ¾ujÃ­cÃ­mi ÄlenskÃ© promÄ›nnÃ©. Ve tÅ™Ã­dÄ› samotnÃ© je uloÅ¾en popis toho, co se dÄ›lÃ¡ s datovÃ½mi sloty. TÃ­m je Å¡etÅ™ena pamÄ›Å¥, neboÅ¥ samotnÃ¡ funkcionalita objektu je v nÃ­ uloÅ¾ena jen jednou pro vÅ¡echny instance.</p>
      <p id="11af0d6d-70f3-4a21-bdb8-df92e5f78096" class="">Self je na prototypech zaloÅ¾enÃ½ jazyk, kde nic jako tÅ™Ã­dy nenÃ­. Objekty nejsou <em>instancovÃ¡ny</em>, ale <em>klonovÃ¡ny</em> z jinÃ½ch objektÅ¯. PÅ™esto, Äi respektive prÃ¡vÄ› proto, je moÅ¾nÃ© pouÅ¾Ã­t stejnÃ½ trik, jako u jazykÅ¯ s tÅ™Ã­dami. PÅ™i klonovÃ¡nÃ­ je v pamÄ›ti vytvoÅ™ena takzvanÃ¡ <em>mapa</em> a uÅ¾ivateli je vrÃ¡cen objekt, kterÃ½ je podobnÄ› jako v pÅ™edchozÃ­m pÅ™Ã­padÄ› pouze polem s hodnotami a pointerem na <em>mapu</em>. Pokud uÅ¾ivatel klon strukturÃ¡lnÄ› modifikuje (pÅ™idÃ¡ / ubere / pÅ™ejmenuje sloty), je pro nÄ›j vytvoÅ™ena samostatnÃ¡ mapa, do tÃ© doby jsou vÅ¡ak mapy sdÃ­leny.</p>
      <p id="b6f79370-efd7-45b9-a5f1-2a36dce8633d" class="">RozloÅ¾enÃ­ v pamÄ›ti se tedy mÄ›nÃ­ nÃ¡sledovnÄ›:</p>
      <pre id="fbf98e12-5e3b-47aa-a60a-5b5eb3c43097" class="code"><code>class Object:
    def __init__(self, map=None):
        self.map = map
        self.scope_parent = None
        self._slot_values = []
        self._parent_slot_values = []

    def clone(self):
        o = Object(self.map)
        o.map = self.map
        o.scope_parent = self.scope_parent
        o._slot_values = self._slot_values[:]
        o._parent_slot_values = self._parent_slot_values[:]

        return o


class Map:
    def __init__(self):
        self._slots = OrderedDict()
        self._parent_slotss = OrderedDict()

        self.primitive_code = None
        self.parameters = []</code></pre>
      <p id="21741387-2229-43ca-891e-98ed9e53116f" class="">V jakÃ©msi pseudoUML to vypadÃ¡ takto:</p>
      <figure id="88334089-2309-4ad4-a5fc-5014522c6dce" class="image">
        <a href="map_0.png" title="map_0.png"><img style="width:178px" src="map_0.png"></a>
      </figure>
      <p id="c1e71aef-4661-44fe-abee-2ee157656e6c" class="">Pokud dojde ke klonovÃ¡nÃ­ objektu, je vytvoÅ™en novÃ½ objekt obsahujÃ­cÃ­ pole s odkazy na hodnoty. VÅ¡echny ostatnÃ­ informace, jako rodiÄovskÃ© sloty, seznam parametrÅ¯ a kÃ³d objektu jsou pro vÅ¡echny klony uloÅ¾enÃ© v jednÃ© mapÄ›, na kterou si pÅ™edÃ¡vajÃ­ reference. DÃ­ky tomu je moÅ¾nÃ© signifikantnÃ­m zpÅ¯sobem Å¡etÅ™it pamÄ›Å¥.</p>
      <figure id="acdd3d53-0803-4da6-a4d8-1dca2f7c4925" class="image">
        <a href="map_1.png" title="map_1.png"><img style="width:419px" src="map_1.png"></a>
      </figure>
      <p id="df090a8a-2d00-4d66-afe1-55bb871bdb6a" class="">To platÃ­, i kdyÅ¾ se zmÄ›nÃ­ hodnota konkrÃ©tnÃ­ho slotu:</p>
      <figure id="e4db1c86-c57b-49d4-b149-5755b676d684" class="image">
        <a href="map_2.png" title="map_2.png"><img style="width:394px" src="map_2.png"></a>
      </figure>
      <p id="62a8fedc-8c30-4c6f-9cdb-570e26b7ec82" class="">CelÃ¡ implementace se ovÅ¡em kapku zesloÅ¾iÅ¥uje v pÅ™Ã­padÄ› kdy se zmÄ›nÃ­ struktura, neboÅ¥ je potÅ™eba patÅ™iÄnÄ› oÅ¡etÅ™it vÅ¡echny manipulace objektu tak, aby doÅ¡lo k vytvoÅ™enÃ­ novÃ© mapy.</p>
      <figure id="599fe379-e581-48a1-ae32-a2b6baf81822" class="image">
        <a href="map_3.png" title="map_3.png"><img style="width:417px" src="map_3.png"></a>
      </figure>
      <p id="1e7521bd-f5cc-469e-a940-76b0e6b5070d" class="">To jsem osobnÄ› vyÅ™eÅ¡il spoustou <code>meta_</code> metod. NapÅ™Ã­klad <code>.meta_add_slot()</code>, kterÃ¡ do klonu pÅ™idÃ¡ novÃ½ slot, pÅ™ed tÃ­m vÅ¡ak vytvoÅ™Ã­ <em>klon mapy</em>, takÅ¾e tento novÃ½ objekt jiÅ¾ pouÅ¾Ã­vÃ¡ vlastnÃ­ mapu, kterou si mÅ¯Å¾e upravovat jak chce.</p>
      <p id="3a2a399c-7f46-4faa-ba47-6fe770e63211" class="">PÅ™eklad nÃ¡zvu slotu probÃ­hÃ¡ nÃ¡sledujÃ­cÃ­m zpÅ¯sobem:</p>
      <p id="5c34a614-1d8d-4e4e-93e1-4f91174338e7" class="">Je zavolÃ¡na metoda <code>.get_slot()</code>, kterÃ¡ se do <em>mapy</em> podÃ­vÃ¡, jestli obsahuje index patÅ™iÄnÃ©ho slotu v <code>OrderedDictionary</code> property <code>._slots</code>. Pokud ano, vezme tento index a najde patÅ™iÄnou hodnotu v poli <code>._slot_values</code>. Tu potom vrÃ¡tÃ­.</p>
      <p id="8bed57e4-77ca-41d7-a68f-35c82764fd05" class="">UloÅ¾enÃ­ novÃ© hodnoty probÃ­hÃ¡ podobnÄ›.</p>
      <h3 id="b176c208-7dac-4574-8f70-bf6b24bac446" class="">Meta operace</h3>
      <p id="85acb3ad-4334-43fd-985f-838aede0158d" class="">Meta-operacemi nazÃ½vÃ¡m takovÃ© operace, kterÃ© nÄ›jak mÄ›nÃ­ strukturu objektu. NapÅ™Ã­klad pÅ™idÃ¡nÃ­ Äi odebrÃ¡nÃ­ novÃ©ho slotu. Vzhledem k tomu Å¾e jsou sloty uloÅ¾eny v <code>OrderedDict</code>u, je touto operacÃ­ i prohozenÃ­ pozice slotu.</p>
      <h3 id="aa82b5b2-311c-4c7b-a5b4-2ab247cb12e9" class="">Kompozice</h3>
      <p id="849d0ac1-3597-40a4-9bc2-57beb4446ce2" class="">Vzhledem k tomu, Å¾e poÄet Å™Ã¡dkÅ¯ narostl z pÅ¯vodnÃ­ nÄ›kolikaÅ™Ã¡dkovÃ© myÅ¡lenky na pÄ›knÃ½ch pÃ¡r stovek, rozhodl jsem se Objekt pro lepÅ¡Ã­ Äitelnost dekomponovat do nÄ›kolika tÅ™Ã­d. Tato dekompozice nemÃ¡ vliv na bÄ›h programu (stejnÄ› je z toho nakonec masivnÄ› <em>inlinovanÃ©</em> C, kterÃ© objekty neznÃ¡), je ÄistÄ› jen pro lepÅ¡Ã­ strukturovanost zdrojovÃ©ho kÃ³du.</p>
      <p id="16286af8-76fe-4aed-80f2-e0b79521fcde" class="">Zde je UML vÃ½slednÃ© podoby <em>objektovÃ©ho layoutu</em>:</p>
      <figure id="6626d9a6-07b9-489d-9d91-b7b0ad50646e" class="image">
        <a href="object_layout.png" title="object_layout.png"><img style="width:887px" src="object_layout.png"></a>
      </figure>
      <p id="6674d19f-8870-4f29-9c75-bab35b56930f" class="">ZdrojovÃ½ kÃ³d je moÅ¾nÃ© najÃ­t v souboru:</p>
      <ul id="6dd913c3-bca7-40eb-b8ec-d7581c8f7de7" class="bulleted-list">
        <li>
          <a href="https://github.com/Bystroushaak/tinySelf/blob/master/src/tinySelf/vm/object_layout.py">object_layout.py</a>
        </li>
      </ul>
      <p id="e51947a8-c75a-47e0-88bf-deff0def1c1c" class="">Oproti tomu co jsem zatÃ­m popsal je moÅ¾nÃ© vidÄ›t jeÅ¡tÄ› mezi-tÅ™Ã­du <code>_ObjectWithMapEncapsulation</code>, coÅ¾ je abstrakce nad vÄ›tÅ¡inou properties v mapÄ›, abych nepÅ™istupoval v kÃ³du interpretru k internÃ­m zÃ¡leÅ¾itostem <em>mapy</em> pÅ™Ã­mo. Pro kÃ³d je mnohem vÃ½hodnÄ›jÅ¡Ã­ a ÄitelnÄ›jÅ¡Ã­, kdyÅ¾ <em>mapa</em> zÅ¯stane ÄÃ­msi na pozadÃ­, optimalizacÃ­, kterÃ¡ je pro vnÄ›jÅ¡Ã­ svÄ›t neviditelnou.</p>
      <h2 id="593c6350-b2f6-4ef8-994d-bba228725465" class="">Parent lookup</h2>
      <p id="1008a195-fa66-45ba-b2a5-ee832710b5b7" class="">Jednou z naprosto klÃ­ÄovÃ½ch funkcionalit Selfu, kterÃ¡ mu dodÃ¡vÃ¡ mnoho elegance, jenÅ¾ napÅ™Ã­klad postrÃ¡dÃ¡ javascript, je delegace na rodiÄovskÃ© sloty.</p>
      <p id="6b21acd2-b363-41d2-9633-b164ea41d126" class=""><code>Object</code> obsahuje kromÄ› metody <code>.get_slot()</code>, jenÅ¾ pouze hledÃ¡ v <em>mapÄ›</em> patÅ™iÄnÃ½ slot, takÃ© metody <code>.parent_lookup()</code> a <code>.slot_lookup()</code>. DruhÃ¡ jmenovanÃ¡ je tÃ­m, co se reÃ¡lnÄ› pouÅ¾Ã­vÃ¡ vÅ¡ude v interpretru.</p>
      <p id="06397d75-eaf5-4a20-9efa-013a72b85c1a" class="">Metoda <code>.parent_lookup()</code> funguje nÃ¡sledovnÄ›:</p>
      <p id="585de5ed-f8d5-4802-a5de-34bc38f64833" class="">Projde vÅ¡echny rodiÄovskÃ© sloty a pokud majÃ­ <code>.visited</code> nastavenÃ© na <code>True</code>, tak je pÅ™eskoÄÃ­. Pokud ne, podÃ­vÃ¡ se do jejich <code>.slots</code> (respektive do jejich mapy..) a zkusÃ­ v nich najÃ­t jmÃ©no slotu. Pokud tam nenÃ­, postupuje rekurzivnÄ› do hloubky pro rodiÄovskÃ© sloty prvnÃ­ho rodiÄovskÃ©ho slotu. VÅ¡echny objekty, kterÃ© navÅ¡tÃ­vÃ­, si oznaÄÃ­ pomocÃ­t property <code>.visited</code> a uloÅ¾Ã­ pro pozdÄ›jÅ¡Ã­ resetovÃ¡nÃ­ tÃ©to property. Pokud je slot nalezen v nÄ›kterÃ©m z rodiÄÅ¯, Äi jeho rodiÄÅ¯, je vrÃ¡cen. Pokud nenÃ­ vÅ¯bec nalezen, je vrÃ¡ceno <code>None</code>. V obou pÅ™Ã­padech jsou nakonec vÅ¡echny proÅ¡lÃ© objekty oznaÄeny jako <code>.visited = False</code>. PrvnÃ­m rodiÄovskÃ½m slotem, kterÃ½ je vÅ¾dy prohledÃ¡vÃ¡m je speciÃ¡lnÃ­ rodiÄovskÃ½ slot <code>.scope_parent</code>, kterÃ½ je pouÅ¾it k uchovÃ¡vÃ¡nÃ­ lokÃ¡lnÃ­ch parametrÅ¯ a kontextu lokÃ¡lnÃ­ch a globÃ¡lnÃ­ch promÄ›nnÃ½ch.</p>
      <p id="f407e2c8-db30-490b-b29d-3d13ed0ae4ff" class="">DruhÃ¡ jmenovanÃ¡ metoda <code>.slot_lookup()</code> se prvnÄ› podÃ­vÃ¡ do vlastnÃ­ho seznamu slotÅ¯ pomocÃ­ <code>.get_slot()</code> a pokud tam nic nenajde, pokraÄuje metodou <code>.parent_lookup()</code>. TÃ­m je implementovanÃ¡ dÄ›diÄnost.</p>
      <h1 id="f7036f96-f008-440b-af54-2b457c482db5" class="">PokraÄovÃ¡nÃ­</h1>
      <p id="129c5c3a-fda8-42ed-b823-39752e2ee7cc" class="">PÅ™Ã­Å¡tÄ› se podÃ­vÃ¡me na bajtkÃ³d a literÃ¡ly a v jakÃ© je to celÃ© uloÅ¾enÃ© datovÃ© struktuÅ™e.</p>
      <h1 id="f5e79f19-5c60-4d03-a200-06785c1f0ae2" class="">RelevantnÃ­ diskuze</h1>
      <ul id="b56a086b-0194-4c2e-9d11-726e78344e1a" class="bulleted-list">
        <li>
          <a href="http://www.abclinuxu.cz/blog/bystroushaak/2019/3/13/444907">Jak se pÃ­Å¡e programovacÃ­ jazyk 4: ObjektovÃ½ layout</a> (abclinuxu)
        </li>
      </ul>
      <p id="24f67f22-0015-4fd5-b796-84ebccd22fd4" class=""></p>
    </div>
  </article>
  <div class="corner-ribbon top-right red">
    <a href="https://www.patreon.com/bePatron?u=2618881">Become a Patron</a>
  </div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8322439660353685" data-ad-slot="4657737295" data-ad-format="auto" data-full-width-responsive="true"></ins> 
  <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
  </script> <a class="twitter-share-button" id="twitter_button" href="#"><img src="../../../tweet_button.svg"></a>
  <div id="sidebar_bottom">
    <div id="last_five_bottom">
      <h3>New posts:</h3>
      <ul>
        <li>
          <a href="../../../en/Weekly_updates/Lifelog_2020-06-15_Todo_in_motion.html" title="Lifelog 2020-06-15; Todo in motion">Lifelog 2020-06-15; Todo in motion</a>
        </li>
        <li>
          <a href="../../../en/My_Greenspuns_counter.html" title="My Greenspun's counter">My Greenspun's counter</a>
        </li>
        <li>
          <a href="../../../en/About_this_blog/What_do_I_mean_by_node.html" title="What do I mean by node?">What do I mean by node?</a>
        </li>
        <li>
          <a href="../../../en/Explorations/Trying_Ansible_alternatives_in_python.html" title="Trying Ansible alternatives in python">Trying Ansible alternatives in python</a>
        </li>
        <li>
          <a href="../../../en/Improvements/The_Most_Personal_Device_experiment/Pebble_smartwatches.html" title="Pebble smartwatches">Pebble smartwatches</a>
        </li>
        <li>
          <a href="../../../en/Improvements/The_Most_Personal_Device_experiment.html" title="The Most Personal Device experiment"><span class="icon">ğŸ“‚</span>The Most Personal Device experiment</a>
        </li>
        <li>
          <a href="../../../en/About_this_blog/Unicode_font_subset.html" title="Unicode font subset">Unicode font subset</a>
        </li>
        <li>
          <a href="../../../en/Weekly_updates/Lifelog_2020-05-25_Work_in_progress_everywhere.html" title="Lifelog 2020-05-25; Work in progress everywhere">Lifelog 2020-05-25; Work in progress everywhere</a>
        </li>
        <li>
          <a href="http://blog.rfox.eu/en/Improvements/Vitamins_nootropics_and_other_boosters.html">Vitamins, nootropics and other boosters</a>
        </li>
        <li>
          <a href="http://blog.rfox.eu/en/objWiki/Transaction_support_for_simple_in_memory_database.html">Transaction support for simple in-memory database</a>
        </li>
      </ul>& <a href="../../../Changelog.html" title="Changelog">more</a>
    </div>
  </div>
</body>
</html>
